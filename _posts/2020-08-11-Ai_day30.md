---
layout: post
title: (AI이노베이션스퀘어_기본과정_Day30) 텐서플로우로 Multi-Variable Linear Regression 구현하기
tags:
  - AI이노베이션스퀘어_기본과정
---

<br>

```python
import tensorflow as tf
import numpy as np
import matplotlib.pyplot as plt
tf.random.set_seed(5)

x_data = [[73.,80.,75.],
          [93.,88.,93.],
          [89.,91.,90.],
          [96.,98.,100.],
          [73.,66.,70.]]

y_data = [[152.],
          [185.],
          [180.],
          [196.],
          [142.]]
```


```python
x_train = np.array(x_data,dtype=np.float32)
y_train = np.array(y_data,dtype=np.float32)
print(x_train.shape,y_train.shape)
```

    (5, 3) (5, 1)

<br>

```python
#변수초기화
#(5,3)*(3,1) => (5*1)
W = tf.Variable(tf.random.normal([3,1]), name='weight')
b = tf.Variable(tf.random.normal([1]), name='bias')
```


```python
#hypothesis : 예측함수, H(x1,x2,x3) = w1*x1 + w2*x2 + w3*x3 + b
def hypothesis(X):
    return tf.matmul(X,W) + b
```


```python
#비용함수, (Hx-y)^2의 평균
def cost_func():
    cost = tf.reduce_mean(tf.square(hypothesis(x_train)-y_train))
    return cost
```


```python
#학습
optimizer = tf.keras.optimizers.Adam(lr=0.01)
print("start learnig")
for step in range(10001):
    #cost를 minimize
    optimizer.minimize(cost_func,var_list = [W,b])
    if step%100 == 0:
        print('%04d'%step,'cost: ',cost_func().numpy(),'W:',W.numpy(),'b:',b.numpy())
print("learning finish")
```

    start learnig
    0000 cost:  42771.19 W: [[-0.7001019 ]
     [ 0.3660163 ]
     [-0.06132571]] b: [-0.7218483]
    0100 cost:  653.97766 W: [[0.00383239]
     [1.0694004 ]
     [0.6424016 ]] b: [-0.0178177]
    0200 cost:  15.068802 W: [[0.10215325]
     [1.1654097 ]
     [0.7398531 ]] b: [0.08090876]
    0300 cost:  14.966806 W: [[0.10438621]
     [1.1643506 ]
     [0.7408481 ]] b: [0.083721]
    0400 cost:  14.886447 W: [[0.10620289]
     [1.1621773 ]
     [0.74116373]] b: [0.0862423]
    0500 cost:  14.793493 W: [[0.10831415]
     [1.1596566 ]
     [0.7415322 ]] b: [0.08917514]
    0600 cost:  14.688687 W: [[0.11070405]
     [1.1568038 ]
     [0.7419487 ]] b: [0.09249961]
    0700 cost:  14.572383 W: [[0.11336431]
     [1.1536287 ]
     [0.7424119 ]] b: [0.09620593]
    0800 cost:  14.44504 W: [[0.11629034]
     [1.1501371 ]
     [0.74292064]] b: [0.10028959]
    0900 cost:  14.306951 W: [[0.11947989]
     [1.1463318 ]
     [0.7434743 ]] b: [0.10474957]
    1000 cost:  14.15822 W: [[0.12293257]
     [1.1422135 ]
     [0.7440727 ]] b: [0.10958761]
    1100 cost:  13.999031 W: [[0.12664925]
     [1.137781  ]
     [0.7447157 ]] b: [0.11480746]
    1200 cost:  13.829478 W: [[0.13063183]
     [1.1330328 ]
     [0.7454034 ]] b: [0.1204146]
    1300 cost:  13.649752 W: [[0.13488306]
     [1.1279658 ]
     [0.7461359 ]] b: [0.12641592]
    1400 cost:  13.45981 W: [[0.13940607]
     [1.1225762 ]
     [0.74691343]] b: [0.1328192]
    1500 cost:  13.259868 W: [[0.14420472]
     [1.1168603 ]
     [0.7477363 ]] b: [0.13963364]
    1600 cost:  13.0499935 W: [[0.14928305]
     [1.1108131 ]
     [0.74860483]] b: [0.14686896]
    1700 cost:  12.830313 W: [[0.15464546]
     [1.10443   ]
     [0.7495194 ]] b: [0.15453592]
    1800 cost:  12.600921 W: [[0.16029663]
     [1.0977057 ]
     [0.75048035]] b: [0.16264622]
    1900 cost:  12.361954 W: [[0.16624121]
     [1.0906353 ]
     [0.7514878 ]] b: [0.17121185]
    2000 cost:  12.113584 W: [[0.17248417]
     [1.0832133 ]
     [0.7525421 ]] b: [0.1802456]
    2100 cost:  11.85605 W: [[0.17903012]
     [1.0754348 ]
     [0.7536434 ]] b: [0.18976088]
    2200 cost:  11.589501 W: [[0.18588372]
     [1.067295  ]
     [0.75479174]] b: [0.1997716]
    2300 cost:  11.314301 W: [[0.1930496]
     [1.0587888]
     [0.7559872]] b: [0.21029213]
    2400 cost:  11.03067 W: [[0.20053187]
     [1.0499123 ]
     [0.75722975]] b: [0.22133715]
    2500 cost:  10.738926 W: [[0.20833455]
     [1.0406616 ]
     [0.75851893]] b: [0.23292202]
    2600 cost:  10.439494 W: [[0.21646124]
     [1.0310332 ]
     [0.75985444]] b: [0.24506211]
    2700 cost:  10.132795 W: [[0.22491501]
     [1.0210243 ]
     [0.7612355 ]] b: [0.2577732]
    2800 cost:  9.819275 W: [[0.23369832]
     [1.0106331 ]
     [0.76266176]] b: [0.27107117]
    2900 cost:  9.499481 W: [[0.24281326]
     [0.99985844]
     [0.7641319 ]] b: [0.28497294]
    3000 cost:  9.173978 W: [[0.25226095]
     [0.9887001 ]
     [0.76564497]] b: [0.2994945]
    3100 cost:  8.843357 W: [[0.26204163]
     [0.97715926]
     [0.7671994 ]] b: [0.31465217]
    3200 cost:  8.508333 W: [[0.27215448]
     [0.9652382 ]
     [0.76879317]] b: [0.33046246]
    3300 cost:  8.16964 W: [[0.28259808]
     [0.9529405 ]
     [0.7704245 ]] b: [0.34694162]
    3400 cost:  7.827989 W: [[0.2933693]
     [0.9402714]
     [0.7720907]] b: [0.36410588]
    3500 cost:  7.4843254 W: [[0.3044644 ]
     [0.92723733]
     [0.7737891 ]] b: [0.38197142]
    3600 cost:  7.139478 W: [[0.31587783]
     [0.9138471 ]
     [0.7755165 ]] b: [0.4005537]
    3700 cost:  6.794368 W: [[0.32760268]
     [0.90011096]
     [0.77726907]] b: [0.4198682]
    3800 cost:  6.449926 W: [[0.33962983]
     [0.88604134]
     [0.77904344]] b: [0.43992954]
    3900 cost:  6.107241 W: [[0.3519497]
     [0.8716532]
     [0.7808344]] b: [0.4607527]
    4000 cost:  5.7672777 W: [[0.3645503 ]
     [0.85696316]
     [0.782637  ]] b: [0.4823511]
    4100 cost:  5.4310336 W: [[0.3774181 ]
     [0.84199065]
     [0.7844454 ]] b: [0.5047383]
    4200 cost:  5.099668 W: [[0.39053714]
     [0.8267571 ]
     [0.78625405]] b: [0.52792615]
    4300 cost:  4.774173 W: [[0.4038897 ]
     [0.81128645]
     [0.7880565 ]] b: [0.55192626]
    4400 cost:  4.4556403 W: [[0.41745618]
     [0.79560626]
     [0.78984517]] b: [0.57674956]
    4500 cost:  4.1450715 W: [[0.43121487]
     [0.77974564]
     [0.79161245]] b: [0.6024057]
    4600 cost:  3.8434334 W: [[0.4451415 ]
     [0.7637363 ]
     [0.79335076]] b: [0.6289028]
    4700 cost:  3.551764 W: [[0.45920998]
     [0.74761325]
     [0.79505146]] b: [0.6562487]
    4800 cost:  3.2708848 W: [[0.4733927 ]
     [0.7314139 ]
     [0.79670465]] b: [0.68445]
    4900 cost:  3.00162 W: [[0.48765975]
     [0.7151773 ]
     [0.79830146]] b: [0.7135124]
    5000 cost:  2.7447836 W: [[0.50197893]
     [0.69894695]
     [0.7998307 ]] b: [0.74343926]
    5100 cost:  2.500935 W: [[0.5163173 ]
     [0.6827659 ]
     [0.80128217]] b: [0.774234]
    5200 cost:  2.2706368 W: [[0.5306388 ]
     [0.66668105]
     [0.8026455 ]] b: [0.80589926]
    5300 cost:  2.054292 W: [[0.54490757]
     [0.6507398 ]
     [0.80390877]] b: [0.8384351]
    5400 cost:  1.85224 W: [[0.55908614]
     [0.6349915 ]
     [0.8050608 ]] b: [0.87184185]
    5500 cost:  1.6646016 W: [[0.5731362]
     [0.6194863]
     [0.80609  ]] b: [0.9061181]
    5600 cost:  1.4914376 W: [[0.5870187 ]
     [0.60427475]
     [0.80698466]] b: [0.9412615]
    5700 cost:  1.3326237 W: [[0.6006951 ]
     [0.58940744]
     [0.80773336]] b: [0.9772692]
    5800 cost:  1.1879141 W: [[0.6141265 ]
     [0.5749345 ]
     [0.80832475]] b: [1.014138]
    5900 cost:  1.0569636 W: [[0.6272756 ]
     [0.5609047 ]
     [0.80874777]] b: [1.0518627]
    6000 cost:  0.9392826 W: [[0.6401056 ]
     [0.54736537]
     [0.8089922 ]] b: [1.090439]
    6100 cost:  0.83424234 W: [[0.6525815 ]
     [0.53436184]
     [0.8090479 ]] b: [1.1298617]
    6200 cost:  0.74119556 W: [[0.6646704 ]
     [0.52193666]
     [0.80890495]] b: [1.1701239]
    6300 cost:  0.6593474 W: [[0.6763427 ]
     [0.5101276 ]
     [0.80855614]] b: [1.2112199]
    6400 cost:  0.58788335 W: [[0.68757117]
     [0.49896923]
     [0.8079938 ]] b: [1.2531434]
    6500 cost:  0.52588975 W: [[0.6983329 ]
     [0.48849076]
     [0.807212  ]] b: [1.2958876]
    6600 cost:  0.4724768 W: [[0.7086087]
     [0.4787164]
     [0.8062059]] b: [1.3394451]
    6700 cost:  0.42673787 W: [[0.7183833 ]
     [0.46966478]
     [0.8049722 ]] b: [1.3838087]
    6800 cost:  0.3877597 W: [[0.7276467 ]
     [0.4613479 ]
     [0.80350924]] b: [1.42897]
    6900 cost:  0.35469574 W: [[0.7363931]
     [0.4537716]
     [0.8018168]] b: [1.4749198]
    7000 cost:  0.32669675 W: [[0.74462205]
     [0.44693464]
     [0.79989696]] b: [1.5216483]
    7100 cost:  0.30301607 W: [[0.7523379 ]
     [0.44082952]
     [0.7977527 ]] b: [1.5691435]
    7200 cost:  0.2829375 W: [[0.75955003]
     [0.43544218]
     [0.7953889 ]] b: [1.6173923]
    7300 cost:  0.26583797 W: [[0.7662721 ]
     [0.43075195]
     [0.7928125 ]] b: [1.6663783]
    7400 cost:  0.25116354 W: [[0.7725223 ]
     [0.42673215]
     [0.7900323 ]] b: [1.716082]
    7500 cost:  0.23844929 W: [[0.7783225]
     [0.4233511]
     [0.7870582]] b: [1.7664813]
    7600 cost:  0.22729301 W: [[0.7836976 ]
     [0.4205722 ]
     [0.78390205]] b: [1.817549]
    7700 cost:  0.21737067 W: [[0.7886755 ]
     [0.4183544 ]
     [0.78057706]] b: [1.869253]
    7800 cost:  0.2084146 W: [[0.79328614]
     [0.4166539 ]
     [0.7770973 ]] b: [1.9215555]
    7900 cost:  0.20023127 W: [[0.79756033]
     [0.41542488]
     [0.77347845]] b: [1.974412]
    8000 cost:  0.19265817 W: [[0.80152917]
     [0.41461968]
     [0.7697366 ]] b: [2.0277696]
    8100 cost:  0.18558934 W: [[0.80522406]
     [0.41419113]
     [0.76588905]] b: [2.081571]
    8200 cost:  0.17894927 W: [[0.8086754 ]
     [0.41409135]
     [0.7619532 ]] b: [2.1357484]
    8300 cost:  0.17267552 W: [[0.8119109 ]
     [0.41427436]
     [0.75794786]] b: [2.1902237]
    8400 cost:  0.16673793 W: [[0.8149572 ]
     [0.41469678]
     [0.75389063]] b: [2.2449162]
    8500 cost:  0.16113225 W: [[0.8178374 ]
     [0.4153173 ]
     [0.74980074]] b: [2.2997303]
    8600 cost:  0.15582797 W: [[0.8205726 ]
     [0.4160975 ]
     [0.74569577]] b: [2.3545644]
    8700 cost:  0.15084228 W: [[0.82318   ]
     [0.41700333]
     [0.74159455]] b: [2.409312]
    8800 cost:  0.14616486 W: [[0.82567304]
     [0.41800353]
     [0.7375153 ]] b: [2.4638562]
    8900 cost:  0.14180484 W: [[0.8280633 ]
     [0.41907066]
     [0.73347545]] b: [2.5180728]
    9000 cost:  0.13775164 W: [[0.83035785]
     [0.4201808 ]
     [0.72949266]] b: [2.5718343]
    9100 cost:  0.13401334 W: [[0.8325619 ]
     [0.42131385]
     [0.725584  ]] b: [2.625009]
    9200 cost:  0.13058813 W: [[0.8346777 ]
     [0.4224517 ]
     [0.72176594]] b: [2.6774657]
    9300 cost:  0.12747045 W: [[0.8367054 ]
     [0.42357975]
     [0.7180541 ]] b: [2.7290683]
    9400 cost:  0.124641515 W: [[0.8386433 ]
     [0.42468587]
     [0.714464  ]] b: [2.7796829]
    9500 cost:  0.122112885 W: [[0.8404883 ]
     [0.42576015]
     [0.7110105 ]] b: [2.8291817]
    9600 cost:  0.11985501 W: [[0.84223706]
     [0.4267933 ]
     [0.70770675]] b: [2.877442]
    9700 cost:  0.11786421 W: [[0.8438847]
     [0.4277788]
     [0.7045659]] b: [2.924343]
    9800 cost:  0.116116956 W: [[0.8454258 ]
     [0.42871046]
     [0.7015999 ]] b: [2.9697785]
    9900 cost:  0.11460241 W: [[0.84685606]
     [0.42958373]
     [0.6988192 ]] b: [3.0136523]
    10000 cost:  0.11329983 W: [[0.8481707]
     [0.4303947]
     [0.6962336]] b: [3.0558832]
    learning finish

